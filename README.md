# spring-study
spring study with Toby-Spring3.1

## jdbc 동작순서
1. db 연결을 위한 connetion 가져오기
2. sql을 담은 statement or preparedstatement를 만든다.
3. 만들어진 statement 실행
4. 조회의 경우 resultset으로 결과를 받아서 저장할 오브젝트에 옮겨준다
5. 작업 중에 생성 된 Connection, Statement, ResultSet 같은 리소스는 작업을 마친 후 반드시 닫아준다.
6. jdbc api 가 만들어내는 예외를 잡아서 직접 처리하거나 메소드에 throws를 선언해서 예외가 발생하면 메소드 밖으로 던지게 한다.

## template method pattern
- 슈퍼클래스의 기본적인 로직의 흐름(커넥션가져오기, sql 생성, 실행, 반환)을 만들고 그 기능의 일부를 추상 메소드나 오버라이딩이 가능한 protected 메소드로 만든 뒤 서브클래스에서 필요에 맞게 구현해서 사용하는 방법

## 팩토리 메소드 패턴
- 서브클래스에서 구체적인 오브젝트 생성 방법을 결정하게 하는 것

## ocp 개방 폐쇄 원칙
- 높은 응집도 
    - 변화가 일어날 때 해당 모듈에서 변하는 부분이 크다.
- 낮은 결합도
    - 책임과 관심사가 다른 오브젝트 또는 모듈과는 느슨한 결합을 해야한다.
    - 변화에 영향이 적어진다.
    - 하나의 오브젝트가변경이 일어날 떄에 관계를 맺고 있는 다른 오브젝트에게 변화를 요구하는 정도를 줄인다.

## 전략 패턴
- 자신의 기능 맥락(context)에서 필요에 따라 변경하는 알고리즘을 인터페이스를 통해 외부로 분리
- UserDao : 전략 패턴 , DB connector 를 interface를 통해서 외부로 분리

# IOC 제어의 역전
- 오브젝트가 자신이 사용할 오브젝틀르 스스로 선택하지 않는다. 당연히 생성하지도 않는다.
- 제어 권한(생성, 사용 등)을 다른 대상에게 위임한다.
- 프레임워크 위에 사용자가 개발한 클래스를 올려 두고 프렘워크가 흐름을 주도하는 중에 코드를 사용하는 방식

## 스프링의 IOC
- bean : 스프링의 어플리케이션 컨텍스트가 생성과 관계설정, 사용 등을 제어해주는 오브젝트
- 설정정보를 통해 빈을 생성하고 관리 한다.
- @Configuration : application context또는 빈팩토리가 사용할 설정 정보라는 어노테이션
- @Bean : 오브 젝트 생성을 담당하는 IoC용 메소드라는 표시

## 어플리에키션 컨텍스트의 동작방식
- @Configuration 어노테이션을 통해 빈을 생성하고 빈을 돌려 준다.

# DI 의존관계 주입
- 스프링에서 제공하는 IoC 기능의 대표적인 동작 원리
- 오브젝트의 레퍼런스를 외부로부터 제공받아 이를 통해 여타 오브젝트와 다이내믹하게 의존관계가 만들어진다.

## 의존관계 검색 (DL)과 의존관계 주입 (DI)
- 의존 관계 검색은 검색하는 오브젝트는 자신이 스프링 빈일 필요가 없다.
    - 스프링api를 직접 호출하여 필요한 빈을 찾아오는 방식
- 컨테이너가 주입하는 오브젝트의 생성과 초기화 권한을 가지고 있어야 한다. 그렇기 때문에 주입을 받을 오브젝트도 빈으로 관리되어야 한다.

## DI의 장점
- 코드에는 런타임 클래스에 대한 의존관계가 나타나지 않고, 인터페이스를 통해 결합도가 낮은 코드를 만들므로, 다른 책임을 가진 사용 의존관계에 있는 대상이 바뀌거나 변경되더라도 영향을 받지 않는다.

## 템플릿/콜백 패턴
- 전략 패턴의 컨텍스트를 템플릿
- 익명 내부 클래스로 만들어지는 오브젝트를 콜백
- 보통 단일 메소드 인터페이스를 사용

# 예외
- Error
    - java.lang.Error 의 서브클래스  시스템에 비정상적인 상황
    - 주로 jvm에서 발생시키는 것
    - code에서 못잡음 try / catch로 잡아봐야 대응방법 없ㅇ므
    - outofmemory , threadDeath
- Exception
    - 어플리케이션 코드작업 중 예외사항 발생했을 경우 사용 되낟.
    - Checked Exception
        - Exception 클래스의 서브 클래스
        - 반드시 예외를 처리하는 코드를 함께 작성해야한다.
        - try / catch  OR  throws
        - ex) IOException , SQLException
        - 강제성 때문에 무책임한 throws의 남발 (나도그랬어 ㅠ)
        - 최근 자바 표준 api들은 unchecked exception으로 변경해서 던진다.
    - Unchecked Exception
        - Exception 클래스의 서브 클래스 이면서 RuntimeException 클래스까지 상속
        - 예외 처리를 강제하지 않는다.
        - try catch  or throws 사용 가능
        - 프로그램의 오류가 있을 때 발생하도록 의도된 것
        - ex) NullPointException / DevideZeroException
- 예외 처리방법
    - 예외 복구
        - 사용자에게 다른 작업 흘므으로 자연스럽게 유도 하거나 , 재시도하는 등의 방법
    - 예외 처리 회피
        - 호출한 쪽으로 던져버린다.
    - 예외 전환
        - 복구해서 정상적인 상태로는 만들 수 없다
        - 예외를 메소드 밖으로 던진다
        - but 발생한 예외를 적절한 예외로 바꾸어서 던진다.
        - 예외를 전활할때는 기존 발생한 예외를 담아서 중첩 예외로 발생시키는 것이 좋다.
- 데ㅔ이터 엑세스 예외 추상화와 DataAccessException
    - 디비별로, 디비접근하는 방식 별로 다른 예외를 추상화하여 일괄되게 적용하기 위한 방법


# 코드 리팩토링 확인점
1. 코드에 중복된 부분은 없는가?
2. 코드가 무엇을 하는 것인지 이해하기 불편하지 않은가?
3. 코드가 자신이 있어야 할 자리에 있는가?
4. 앞으로 변경이 일어난다면 어떤 것이 있을 수 있고, 그 변화에 쉽게 대응할 수 있게 작성되어 있는가?


## SPRING

# 애플리케이션 프레임 워크
- 특정 계층이나 기술 업무 분야에 국한되지 않고 애플리케이션의 전 영역을 포괄하는 범용적 프레임워크
- 일관된 프로그래밍 모델과 핵심 기술을 바탕으로 해서 각 분야의 특성에 맞는 필요를 채워준다.
# 경량급
- 불필요하게 무겁지 않다
- 단순한 톰캣위에서도 동작한다.
# 기술적 복잡함을 상대하는 전략
- 기술적인 복잡함을 추상화를 통해 기술 구현 부분과 인터페이스를 분리
- aop 등을 통해 비즈니스 로직에만 집중되게 한다
- DB는 단지 데이터의 영구적인 저장과 복잡한 조건을 가진 검색과 같은 자체적으로  특화된 기능만 사용한다.
- DI를 잘 사용하면 객체지향을 잘 살린 개발이 가능하다.

# Pojo
- 스프링은 pojo를 이용해서 만든 애플리케이션 코드와 pojo가 어떻게 관계를 맺고 동작하는지를 정의해놓은 설계정보로 구분된다.
- 특정 규약에 종속되지 않는다.
    - 자바 언어와 꼭 필요한 API 외에는 종속되지 않아야 한다.
    
- 특정 환경에 종속되지 않는다.
    - jndi 같은 특정 환경이 의존 대상 검색 방식에 종속적이라면 pojo가 아니다.
    
- 객체지향적인 원리에 충실하면서, 환경과 기술에 종속되지 않고 필요에 따라 재활용될 수 있는 방식으로 설계된 오브젝트를 말한다.
- 특정한 규약이나 환경에 종속되지 않는 오브젝트는 깔끔한 코드가 된다.
- 스프링은 비즈니스로직에서는 환경적인 서비스 기술들을 숨겨놓게한다.
- A -> B의 의존 관계에서 `확장`은 B의 관점에서 B가 변화해도 상관없다는 뜻이다.
- DI의 장점
    - 핵심 기능의 변경 : A -> B에서 B를 B1으로 통째로 변경이 가능하다.
    - 핵심기능의 동적인 변경 : 런타임 시에 동적으로 의존 오브젝트를 연결해줄 수 있따.
    - EX) Dao에서 사용자의 등급에 따라 다른 datasource를 바라보게 할 수 있다.
    - 부가기능의 추가 - 데코레이터 패턴으로 로깅이나 보안처리ㄷ 같은 기능을 추가해줄수있다. 특정 방식을 많은 대상으로 일반화하면 AOP
    - 인터페이스의 변경
        - A -> B의 구조에서 유사한 C를 A가 받으려면 C를 B로 변환해주는 어답터로 만들어주면 된다. A -> B(C로 위임) -> C
    - 템플릿과 콜백 고정적인 작업 흐름과 그 사이에서 자주 바뀌는 부분을 분리하는 템플릿 and 콜백으로 만든다.
- AOP의 적용방법
    1. 미리 준비된 AOP 이용 : 스프링이 미리 만들어서 제공하는 AOP기능을 가져다 적용한다 ex) 트랜잭션
    2. 전담 팀을 통한 정책 AOP 적용 : 소수의 담당자들이 비즈니스로직 보안, 로깅, 트레이싱 등의 기능에 AOP적용
        - 가이드라인에 따라 개발할 수 있도록
    3. 자유로운 이용 : 개발자 개개인이 자기가 필요한 세부적인 곳에 사용한다.
